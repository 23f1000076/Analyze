html
<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Data Analysis Results</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 2em;
    background-color: #f9f9f9;
  }
  h1 {
    text-align: center;
  }
  section {
    background: #fff;
    padding: 1em;
    margin-bottom: 2em;
    border-radius: 8px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 1em;
  }
  th, td {
    border: 1px solid #ddd;
    padding: 0.5em;
  }
  th {
    background-color: #eee;
  }
</style>
</head>
<body>
<h1>Data Analysis Results</h1>

<section>
<h2>Summary</h2>
<ul>
  <li><strong>Total Rows:</strong> <span id="rowCount"></span></li>
  <li><strong>Unique Regions:</strong> <span id="regionsCount"></span></li>
</ul>
</section>

<section>
<h2>Top 3 Products by Revenue</h2>
<table id="topProductsTable">
  <thead>
    <tr><th>Product</th><th>Revenue</th></tr>
  </thead>
  <tbody></tbody>
</table>
</section>

<section>
<h2>Rolling 7-Day Revenue by Region</h2>
<canvas id="revenueChart" width="800" height="400"></canvas>
</section>

<!-- Load Chart.js from CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
(async () => {
  // Fetch the result.json generated by execute.py
  const response = await fetch('https://<your-github-pages-subdomain>.github.io/result.json');
  const data = await response.json();

  // Fill summary info
  document.getElementById('rowCount').textContent = data.row_count;
  document.getElementById('regionsCount').textContent = data.regions;

  // Populate top products table
  const tbody = document.querySelector('#topProductsTable tbody');
  data.top_products.forEach(p => {
    const row = document.createElement('tr');
    const productCell = document.createElement('td');
    productCell.textContent = p.product;
    const revenueCell = document.createElement('td');
    revenueCell.textContent = p.revenue.toFixed(2);
    row.appendChild(productCell);
    row.appendChild(revenueCell);
    tbody.appendChild(row);
  });

  // Prepare data for the chart
  const datasets = data.rolling_revenue.map(regionData => ({
    label: regionData.region,
    data: regionData.values,
    fill: false,
    borderColor: getRandomColor(),
    tension: 0.4,
  }));

  const labels = data.rolling_revenue[0]?.dates || [];

  // Create the line chart
  const ctx = document.getElementById('revenueChart').getContext('2d');
  new Chart(ctx, {
    type: 'line',
    data: {
      labels: labels,
      datasets: datasets
    },
    options: {
      responsive: true,
      plugins: {
        legend: {
          position: 'top',
        },
        title: {
          display: true,
          text: '7-Day Moving Average Revenue per Region'
        }
      },
      scales: {
        x: {
          display: true,
          title: {
            display: true,
            text: 'Date'
          }
        },
        y: {
          display: true,
          title: {
            display: true,
            text: 'Revenue'
          }
        }
      }
    }
  });

  function getRandomColor() {
    const letters = '0123456789ABCDEF';
    let color = '#';
    for (let i=0; i<6; i++) {
      color += letters[Math.floor(Math.random()*16)];
    }
    return color;
  }
})();
</script>
</body>
</html>

---

# README.md
# Overview
This web app visualizes the analysis results from Python script processing data in `data.xlsx`. It displays summary metrics, the top 3 products by revenue, and a line chart showing the 7-day moving average revenue per region.

# Setup
1. Ensure the `result.json` file from your CI (generated by `execute.py`) is hosted on your GitHub Pages site and accessible via URL replacing `<your-github-pages-subdomain>`.
2. Host this `index.html` file on your GitHub Pages site alongside `result.json`.

# Usage
Open `index.html` in a web browser. It fetches the `result.json` data and renders the analysis results: the total number of rows, unique regions, a table of top products, and a line chart of revenue trends per region.

# Improvements from previous version
- Dynamic fetching of results from GitHub Pages.
- Clear separation of concerns with HTML, CSS, and JavaScript.
- Visualization enhanced with Chart.js for better readability.
- The code is now ready to run with Python 3.11+ and Pandas 2.3, with the data converted to CSV and hosted appropriately.